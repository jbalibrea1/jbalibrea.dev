---
import PostCard from '@/components/PostCard.astro';
import HomeLayout from '@/layouts/HomeLayout.astro';
import Pagination from '@components/Pagination.astro';
import { SITE } from '@config';
import getShortedPosts from '@utils/getSorterPosts';
import type { GetStaticPaths, Page } from 'astro';
import type { CollectionEntry } from 'astro:content';
import { getCollection } from 'astro:content';

// const allPosts = await getCollection('posts');
// const ShorterPosts = getShortedPosts(allPosts);

export const getStaticPaths = (async ({ paginate }) => {
  const posts = await getCollection('posts');
  const sortedPosts = getShortedPosts(posts);
  return paginate(sortedPosts, { pageSize: SITE.postPerPage });
}) satisfies GetStaticPaths;

export interface Props {
  page: Page<CollectionEntry<'posts'>>;
}
const { page } = Astro.props;
const title = 'Blog de Desarrollo Web y Tecnología - jbalibrea.dev';
const description =
  'Artículos de Jorge Balibrea sobre desarrollo web, diseño y tecnología - jbalibrea.dev';
---

<HomeLayout title={title} description={description}>
  <main>
    <section class="pb-8">
      <h1 class="text-4xl text-current uppercase inline-block mb-4">
        Blog de <span class="font-extrabold tracking-tight dark:text-white">
          jbalibrea</span
        >
      </h1>
      <a
        target="_blank"
        href="/rss.xml"
        class="inline-block"
        aria-label="rss feed"
        title="RSS Feed"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-6 w-6 scale-110 fill-accent"
          ><path
            d="M19 20.001C19 11.729 12.271 5 4 5v2c7.168 0 13 5.832 13 13.001h2z"
          ></path><path
            d="M12 20.001h2C14 14.486 9.514 10 4 10v2c4.411 0 8 3.589 8 8.001z"
          ></path><circle cx="6" cy="18" r="2"></circle>
        </svg>
        <span class="sr-only">RSS Feed</span>
      </a>
      <p>
        Desarrollador apasionado por la programación. Iré escribiendo artículos
        sobre lo que más me gusta: el desarrollo de software, tanto en el lado
        del frontend como en el backend, junto con temas de crecimiento personal
        y profesional. ¡Espero que encuentres contenido interesante y útil para
        tu propio desarrollo!
      </p>
    </section>
    <ul>
      {
        page.data.map(({ data, slug }) => (
          <PostCard href={`/blog/posts/${slug}`} post={data} />
        ))
      }
    </ul>
    <Pagination page={page} />
  </main>
</HomeLayout>
